<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bdcor.pip.web.data.dao.UqsHandleViewMapper">
  <resultMap id="BaseResultMap" type="com.bdcor.pip.web.data.domain.UqsHandleView">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="PATIENT_ID" jdbcType="VARCHAR" property="patientId" />
    <result column="LCC_CODE" jdbcType="VARCHAR" property="lccCode" />
    <result column="PATIENT_NAME" jdbcType="VARCHAR" property="patientName" />
    <result column="SEX" jdbcType="VARCHAR" property="sex" />
    <result column="NATION" jdbcType="VARCHAR" property="nation" />
    <result column="ID_NUMBER" jdbcType="VARCHAR" property="idNumber" />
    <result column="RISK_CODE" jdbcType="VARCHAR" property="riskCode" />
    <result column="RISK_DATE" jdbcType="TIMESTAMP" property="riskDate" />
    <result column="PATIENT_DATE" jdbcType="TIMESTAMP" property="patientDate" />
    <result column="UQS1" jdbcType="VARCHAR" property="uqs1" />
    <result column="UQS2" jdbcType="VARCHAR" property="uqs2" />
    <result column="UQS3" jdbcType="VARCHAR" property="uqs3" />
    <result column="UQS4" jdbcType="VARCHAR" property="uqs4" />
    <result column="UQS5" jdbcType="VARCHAR" property="uqs5" />
    <result column="UQS6" jdbcType="VARCHAR" property="uqs6" />
    <result column="UQS1_START" jdbcType="TIMESTAMP" property="uqs1Start" />
    <result column="UQS1_END" jdbcType="TIMESTAMP" property="uqs1End" />
    <result column="UQS1_DATE" jdbcType="TIMESTAMP" property="uqs1Date" />
    <result column="UQS2_START" jdbcType="TIMESTAMP" property="uqs2Start" />
    <result column="UQS2_END" jdbcType="TIMESTAMP" property="uqs2End" />
    <result column="UQS2_DATE" jdbcType="TIMESTAMP" property="uqs2Date" />
    <result column="UQS3_START" jdbcType="TIMESTAMP" property="uqs3Start" />
    <result column="UQS3_END" jdbcType="TIMESTAMP" property="uqs3End" />
    <result column="UQS3_DATE" jdbcType="TIMESTAMP" property="uqs3Date" />
    <result column="UQS4_START" jdbcType="TIMESTAMP" property="uqs4Start" />
    <result column="UQS4_END" jdbcType="TIMESTAMP" property="uqs4End" />
    <result column="UQS4_DATE" jdbcType="TIMESTAMP" property="uqs4Date" />
    <result column="UQS5_START" jdbcType="TIMESTAMP" property="uqs5Start" />
    <result column="UQS5_END" jdbcType="TIMESTAMP" property="uqs5End" />
    <result column="UQS5_DATE" jdbcType="TIMESTAMP" property="uqs5Date" />
    <result column="UQS6_START" jdbcType="TIMESTAMP" property="uqs6Start" />
    <result column="UQS6_END" jdbcType="TIMESTAMP" property="uqs6End" />
    <result column="UQS6_DATE" jdbcType="TIMESTAMP" property="uqs6Date" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, RISK_DATE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
  </sql>
  <select id="selectByExample" parameterType="com.bdcor.pip.web.data.domain.UqsHandleViewExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from UQS_HANDLE_VIEW
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <delete id="deleteByExample" parameterType="com.bdcor.pip.web.data.domain.UqsHandleViewExample">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from UQS_HANDLE_VIEW
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.bdcor.pip.web.data.domain.UqsHandleView">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into UQS_HANDLE_VIEW (PATIENT_ID, LCC_CODE, PATIENT_NAME, 
      SEX, NATION, ID_NUMBER, 
      RISK_CODE, RISK_DATE, PATIENT_DATE, 
      UQS1, UQS2, UQS3, UQS4, 
      UQS5, UQS6, UQS1_START, 
      UQS1_END, UQS1_DATE, UQS2_START, 
      UQS2_END, UQS2_DATE, UQS3_START, 
      UQS3_END, UQS3_DATE, UQS4_START, 
      UQS4_END, UQS4_DATE, UQS5_START, 
      UQS5_END, UQS5_DATE, UQS6_START, 
      UQS6_END, UQS6_DATE)
    values (#{patientId,jdbcType=VARCHAR}, #{lccCode,jdbcType=VARCHAR}, #{patientName,jdbcType=VARCHAR}, 
      #{sex,jdbcType=VARCHAR}, #{nation,jdbcType=VARCHAR}, #{idNumber,jdbcType=VARCHAR}, 
      #{riskCode,jdbcType=VARCHAR}, #{riskDate,jdbcType=TIMESTAMP}, #{patientDate,jdbcType=TIMESTAMP}, 
      #{uqs1,jdbcType=VARCHAR}, #{uqs2,jdbcType=VARCHAR}, #{uqs3,jdbcType=VARCHAR}, #{uqs4,jdbcType=VARCHAR}, 
      #{uqs5,jdbcType=VARCHAR}, #{uqs6,jdbcType=VARCHAR}, #{uqs1Start,jdbcType=TIMESTAMP}, 
      #{uqs1End,jdbcType=TIMESTAMP}, #{uqs1Date,jdbcType=TIMESTAMP}, #{uqs2Start,jdbcType=TIMESTAMP}, 
      #{uqs2End,jdbcType=TIMESTAMP}, #{uqs2Date,jdbcType=TIMESTAMP}, #{uqs3Start,jdbcType=TIMESTAMP}, 
      #{uqs3End,jdbcType=TIMESTAMP}, #{uqs3Date,jdbcType=TIMESTAMP}, #{uqs4Start,jdbcType=TIMESTAMP}, 
      #{uqs4End,jdbcType=TIMESTAMP}, #{uqs4Date,jdbcType=TIMESTAMP}, #{uqs5Start,jdbcType=TIMESTAMP}, 
      #{uqs5End,jdbcType=TIMESTAMP}, #{uqs5Date,jdbcType=TIMESTAMP}, #{uqs6Start,jdbcType=TIMESTAMP}, 
      #{uqs6End,jdbcType=TIMESTAMP}, #{uqs6Date,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.bdcor.pip.web.data.domain.UqsHandleView">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into UQS_HANDLE_VIEW
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="patientId != null">
        PATIENT_ID,
      </if>
      <if test="lccCode != null">
        LCC_CODE,
      </if>
      <if test="patientName != null">
        PATIENT_NAME,
      </if>
      <if test="sex != null">
        SEX,
      </if>
      <if test="nation != null">
        NATION,
      </if>
      <if test="idNumber != null">
        ID_NUMBER,
      </if>
      <if test="riskCode != null">
        RISK_CODE,
      </if>
      <if test="riskDate != null">
        RISK_DATE,
      </if>
      <if test="patientDate != null">
        PATIENT_DATE,
      </if>
      <if test="uqs1 != null">
        UQS1,
      </if>
      <if test="uqs2 != null">
        UQS2,
      </if>
      <if test="uqs3 != null">
        UQS3,
      </if>
      <if test="uqs4 != null">
        UQS4,
      </if>
      <if test="uqs5 != null">
        UQS5,
      </if>
      <if test="uqs6 != null">
        UQS6,
      </if>
      <if test="uqs1Start != null">
        UQS1_START,
      </if>
      <if test="uqs1End != null">
        UQS1_END,
      </if>
      <if test="uqs1Date != null">
        UQS1_DATE,
      </if>
      <if test="uqs2Start != null">
        UQS2_START,
      </if>
      <if test="uqs2End != null">
        UQS2_END,
      </if>
      <if test="uqs2Date != null">
        UQS2_DATE,
      </if>
      <if test="uqs3Start != null">
        UQS3_START,
      </if>
      <if test="uqs3End != null">
        UQS3_END,
      </if>
      <if test="uqs3Date != null">
        UQS3_DATE,
      </if>
      <if test="uqs4Start != null">
        UQS4_START,
      </if>
      <if test="uqs4End != null">
        UQS4_END,
      </if>
      <if test="uqs4Date != null">
        UQS4_DATE,
      </if>
      <if test="uqs5Start != null">
        UQS5_START,
      </if>
      <if test="uqs5End != null">
        UQS5_END,
      </if>
      <if test="uqs5Date != null">
        UQS5_DATE,
      </if>
      <if test="uqs6Start != null">
        UQS6_START,
      </if>
      <if test="uqs6End != null">
        UQS6_END,
      </if>
      <if test="uqs6Date != null">
        UQS6_DATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="patientId != null">
        #{patientId,jdbcType=VARCHAR},
      </if>
      <if test="lccCode != null">
        #{lccCode,jdbcType=VARCHAR},
      </if>
      <if test="patientName != null">
        #{patientName,jdbcType=VARCHAR},
      </if>
      <if test="sex != null">
        #{sex,jdbcType=VARCHAR},
      </if>
      <if test="nation != null">
        #{nation,jdbcType=VARCHAR},
      </if>
      <if test="idNumber != null">
        #{idNumber,jdbcType=VARCHAR},
      </if>
      <if test="riskCode != null">
        #{riskCode,jdbcType=VARCHAR},
      </if>
      <if test="riskDate != null">
        #{riskDate,jdbcType=TIMESTAMP},
      </if>
      <if test="patientDate != null">
        #{patientDate,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs1 != null">
        #{uqs1,jdbcType=VARCHAR},
      </if>
      <if test="uqs2 != null">
        #{uqs2,jdbcType=VARCHAR},
      </if>
      <if test="uqs3 != null">
        #{uqs3,jdbcType=VARCHAR},
      </if>
      <if test="uqs4 != null">
        #{uqs4,jdbcType=VARCHAR},
      </if>
      <if test="uqs5 != null">
        #{uqs5,jdbcType=VARCHAR},
      </if>
      <if test="uqs6 != null">
        #{uqs6,jdbcType=VARCHAR},
      </if>
      <if test="uqs1Start != null">
        #{uqs1Start,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs1End != null">
        #{uqs1End,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs1Date != null">
        #{uqs1Date,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs2Start != null">
        #{uqs2Start,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs2End != null">
        #{uqs2End,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs2Date != null">
        #{uqs2Date,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs3Start != null">
        #{uqs3Start,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs3End != null">
        #{uqs3End,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs3Date != null">
        #{uqs3Date,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs4Start != null">
        #{uqs4Start,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs4End != null">
        #{uqs4End,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs4Date != null">
        #{uqs4Date,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs5Start != null">
        #{uqs5Start,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs5End != null">
        #{uqs5End,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs5Date != null">
        #{uqs5Date,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs6Start != null">
        #{uqs6Start,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs6End != null">
        #{uqs6End,jdbcType=TIMESTAMP},
      </if>
      <if test="uqs6Date != null">
        #{uqs6Date,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.bdcor.pip.web.data.domain.UqsHandleViewExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(*) from UQS_HANDLE_VIEW
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update UQS_HANDLE_VIEW
    <set>
      <if test="record.patientId != null">
        PATIENT_ID = #{record.patientId,jdbcType=VARCHAR},
      </if>
      <if test="record.lccCode != null">
        LCC_CODE = #{record.lccCode,jdbcType=VARCHAR},
      </if>
      <if test="record.patientName != null">
        PATIENT_NAME = #{record.patientName,jdbcType=VARCHAR},
      </if>
      <if test="record.sex != null">
        SEX = #{record.sex,jdbcType=VARCHAR},
      </if>
      <if test="record.nation != null">
        NATION = #{record.nation,jdbcType=VARCHAR},
      </if>
      <if test="record.idNumber != null">
        ID_NUMBER = #{record.idNumber,jdbcType=VARCHAR},
      </if>
      <if test="record.riskCode != null">
        RISK_CODE = #{record.riskCode,jdbcType=VARCHAR},
      </if>
      <if test="record.riskDate != null">
        RISK_DATE = #{record.riskDate,jdbcType=TIMESTAMP},
      </if>
      <if test="record.patientDate != null">
        PATIENT_DATE = #{record.patientDate,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs1 != null">
        UQS1 = #{record.uqs1,jdbcType=VARCHAR},
      </if>
      <if test="record.uqs2 != null">
        UQS2 = #{record.uqs2,jdbcType=VARCHAR},
      </if>
      <if test="record.uqs3 != null">
        UQS3 = #{record.uqs3,jdbcType=VARCHAR},
      </if>
      <if test="record.uqs4 != null">
        UQS4 = #{record.uqs4,jdbcType=VARCHAR},
      </if>
      <if test="record.uqs5 != null">
        UQS5 = #{record.uqs5,jdbcType=VARCHAR},
      </if>
      <if test="record.uqs6 != null">
        UQS6 = #{record.uqs6,jdbcType=VARCHAR},
      </if>
      <if test="record.uqs1Start != null">
        UQS1_START = #{record.uqs1Start,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs1End != null">
        UQS1_END = #{record.uqs1End,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs1Date != null">
        UQS1_DATE = #{record.uqs1Date,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs2Start != null">
        UQS2_START = #{record.uqs2Start,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs2End != null">
        UQS2_END = #{record.uqs2End,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs2Date != null">
        UQS2_DATE = #{record.uqs2Date,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs3Start != null">
        UQS3_START = #{record.uqs3Start,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs3End != null">
        UQS3_END = #{record.uqs3End,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs3Date != null">
        UQS3_DATE = #{record.uqs3Date,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs4Start != null">
        UQS4_START = #{record.uqs4Start,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs4End != null">
        UQS4_END = #{record.uqs4End,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs4Date != null">
        UQS4_DATE = #{record.uqs4Date,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs5Start != null">
        UQS5_START = #{record.uqs5Start,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs5End != null">
        UQS5_END = #{record.uqs5End,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs5Date != null">
        UQS5_DATE = #{record.uqs5Date,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs6Start != null">
        UQS6_START = #{record.uqs6Start,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs6End != null">
        UQS6_END = #{record.uqs6End,jdbcType=TIMESTAMP},
      </if>
      <if test="record.uqs6Date != null">
        UQS6_DATE = #{record.uqs6Date,jdbcType=TIMESTAMP},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update UQS_HANDLE_VIEW
    set PATIENT_ID = #{record.patientId,jdbcType=VARCHAR},
      LCC_CODE = #{record.lccCode,jdbcType=VARCHAR},
      PATIENT_NAME = #{record.patientName,jdbcType=VARCHAR},
      SEX = #{record.sex,jdbcType=VARCHAR},
      NATION = #{record.nation,jdbcType=VARCHAR},
      ID_NUMBER = #{record.idNumber,jdbcType=VARCHAR},
      RISK_CODE = #{record.riskCode,jdbcType=VARCHAR},
      RISK_DATE = #{record.riskDate,jdbcType=TIMESTAMP},
      PATIENT_DATE = #{record.patientDate,jdbcType=TIMESTAMP},
      UQS1 = #{record.uqs1,jdbcType=VARCHAR},
      UQS2 = #{record.uqs2,jdbcType=VARCHAR},
      UQS3 = #{record.uqs3,jdbcType=VARCHAR},
      UQS4 = #{record.uqs4,jdbcType=VARCHAR},
      UQS5 = #{record.uqs5,jdbcType=VARCHAR},
      UQS6 = #{record.uqs6,jdbcType=VARCHAR},
      UQS1_START = #{record.uqs1Start,jdbcType=TIMESTAMP},
      UQS1_END = #{record.uqs1End,jdbcType=TIMESTAMP},
      UQS1_DATE = #{record.uqs1Date,jdbcType=TIMESTAMP},
      UQS2_START = #{record.uqs2Start,jdbcType=TIMESTAMP},
      UQS2_END = #{record.uqs2End,jdbcType=TIMESTAMP},
      UQS2_DATE = #{record.uqs2Date,jdbcType=TIMESTAMP},
      UQS3_START = #{record.uqs3Start,jdbcType=TIMESTAMP},
      UQS3_END = #{record.uqs3End,jdbcType=TIMESTAMP},
      UQS3_DATE = #{record.uqs3Date,jdbcType=TIMESTAMP},
      UQS4_START = #{record.uqs4Start,jdbcType=TIMESTAMP},
      UQS4_END = #{record.uqs4End,jdbcType=TIMESTAMP},
      UQS4_DATE = #{record.uqs4Date,jdbcType=TIMESTAMP},
      UQS5_START = #{record.uqs5Start,jdbcType=TIMESTAMP},
      UQS5_END = #{record.uqs5End,jdbcType=TIMESTAMP},
      UQS5_DATE = #{record.uqs5Date,jdbcType=TIMESTAMP},
      UQS6_START = #{record.uqs6Start,jdbcType=TIMESTAMP},
      UQS6_END = #{record.uqs6End,jdbcType=TIMESTAMP},
      UQS6_DATE = #{record.uqs6Date,jdbcType=TIMESTAMP}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <select id="reportUqsForLcc" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
select
  lcc_code ,
  (select p.lcc_name from pip_comm_lcc p where p.lcc_code = ttt.lcc_code ) as lcc_name ,
  max(case uqs when '000' then num else 0 end) as uqs0,
  max(case uqs when '001001' then num else 0 end) as uqs1,
  max(case uqs when '001002' then num else 0 end) as uqs2,
  max(case uqs when '001003' then num else 0 end) as uqs3,
  max(case uqs when '001004' then num else 0 end) as uqs4,
  max(case uqs when '001005' then num else 0 end) as uqs5,
  max(case uqs when '001006' then num else 0 end) as uqs6
from
(select lcc_code , uqs , num from
(
select lcc_code , uqs ,  num from
(select lcc_code , '000' as uqs , count(1) as num  from uqs_handle_view where patient_name is not null
<if test="start != null">
	and patient_date &gt;= #{start}
</if>
<if test="end != null">
	and patient_date &lt;= #{end}
</if>
group by lcc_code, '000') u0
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code , uqs1 as uqs , count(1) as num  from uqs_handle_view where uqs1 = '001001'
<if test="start != null">
	and uqs1_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs1_date &lt;= #{end}
</if>
group by lcc_code , uqs1) u1
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs2 as uqs , count(1) as num  from uqs_handle_view where uqs2 = '001002' 
<if test="start != null">
	and uqs2_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs2_date &lt;= #{end}
</if>
group by lcc_code , uqs2) u2
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs3 as uqs , count(1) as num  from uqs_handle_view where uqs3 = '001003' 
<if test="start != null">
	and uqs3_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs3_date &lt;= #{end}
</if>
group by lcc_code , uqs3) u3
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs4 as uqs, count(1) as num  from uqs_handle_view where uqs4 = '001004' 
<if test="start != null">
	and uqs4_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs4_date &lt;= #{end}
</if>
group by lcc_code , uqs4) u4
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs5 as uqs , count(1) as num  from uqs_handle_view where uqs5 = '001005' 
<if test="start != null">
	and uqs5_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs5_date &lt;= #{end}
</if>
group by lcc_code , uqs5) u5
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs6 as uqs , count(1) as num  from uqs_handle_view where uqs6 = '001006' 
<if test="start != null">
	and uqs6_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs6_date &lt;= #{end}
</if>
group by lcc_code , uqs6) u6
) t 
) ttt
where lcc_code in
<foreach item="item" index="index" collection="datalimits" open="(" separator="," close=")">  
  #{item}  
</foreach>  
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>
group by lcc_code order by lcc_code 
  </select>
  <select id="reportProgressForLcc" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
select lcc_code , lcc_name , 
uqs2 , 
round(uqs2/200 , 0 ) as uqs2_per , 
risk , 
case when uqs2 &gt; 0 then round(risk*100/uqs2,0) else 0 end as risk_per ,
uqs34 , 
round(uqs34/40 , 0 ) as uqs34_per,
uqs5 , 
case when uqs34 &gt; 0 then round(uqs5*100/uqs34 , 0) else 0 end as uqs5_per ,
uqs6 ,
case when uqs5 &gt; 0 then round(uqs6*100/uqs5 , 0) else 0 end as uqs6_per,
interview,
case when uqs6 > 0 then round(interview*100/uqs6 , 0) else 0 end as interview_per
from 
(select
  lcc_code ,
  (select p.lcc_name from pip_comm_lcc p where p.lcc_code = ttt.lcc_code ) as lcc_name ,
  max(case uqs when 'risk' then num else 0 end) as risk,
  max(case uqs when '001001' then num else 0 end) as uqs1,
  max(case uqs when '001002' then num else 0 end) as uqs2,
  max(case uqs when '003004' then num else 0 end) as uqs34,
  max(case uqs when '001005' then num else 0 end) as uqs5,
  max(case uqs when '001006' then num else 0 end) as uqs6,
  max(case uqs when 'interview' then num else 0 end) as interview
from
(select lcc_code , uqs , num from
(
select lcc_code , uqs ,  num from
(select substr(patient_id , 0 ,4 ) as lcc_code, 'risk' as uqs , count(1) as num  from uqs_answer_001002_13_1 where risk is not null

<if test="start != null">
	and risk &gt;= #{start}
</if>
<if test="end != null">
	and risk &lt;= #{end}
</if>
group by substr(patient_id , 0 ,4 ), 'risk') u0
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code , uqs1 as uqs , count(1) as num  from uqs_handle_view where uqs1 = '001001'
<if test="start != null">
	and uqs1_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs1_date &lt;= #{end}
</if>
group by lcc_code , uqs1) u1
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs2 as uqs , count(1) as num  from uqs_handle_view where uqs2 = '001002' 
<if test="start != null">
	and uqs2_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs2_date &lt;= #{end}
</if>
group by lcc_code , uqs2) u2
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , '003004' as uqs , count(1) as num  from uqs_handle_view where uqs3 = '001003' and uqs4 = '001004'
<if test="start != null">
	and uqs4_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs4_date &lt;= #{end}
</if>
group by lcc_code, '003004') u3
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs5 as uqs , count(1) as num  from uqs_handle_view where uqs5 = '001005' 
<if test="start != null">
	and uqs5_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs5_date &lt;= #{end}
</if>
group by lcc_code , uqs5) u5
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs6 as uqs , count(1) as num  from uqs_handle_view where uqs6 = '001006' 
<if test="start != null">
	and uqs6_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs6_date &lt;= #{end}
</if>
group by lcc_code , uqs6) u6
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'interview' as uqs , count(1) as num  from pip_comm_patient_qa where interview_date is not null 
<if test="start != null">
	and interview_date &gt;= #{start}
</if>
<if test="end != null">
	and interview_date &lt;= #{end}
</if>
group by lcc_code) u7
) t 
) ttt
where 1 = 1
group by lcc_code) t4  
where lcc_code in
<foreach item="item" index="index" collection="datalimits" open="(" separator="," close=")">  
  #{item}  
</foreach>  
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
  order by lcc_code
  
  </select>
  
  <select id="listUqs0" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
	select 
	PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
	from UQS_HANDLE_VIEW
	where 1 = 1 
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="start != null">
	and patient_date &gt;= #{start}
</if>
<if test="end != null">
	and patient_date &lt;= #{end}
</if>
<if test="patientId != null">
	and (PATIENT_ID = #{patientId} or RISK_CODE = #{patientId} )
</if>
<if test="patientName != null">
	and PATIENT_NAME like '%${patientName}%'
</if>
order by patient_id
</select>

<select id="listUqs1" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
	select 
	PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
	from UQS_HANDLE_VIEW
	where 1 = 1 
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="start != null">
	and UQS1_DATE &gt;= #{start}
</if>
<if test="end != null">
	and UQS1_DATE &lt;= #{end}
</if>
<if test="patientId != null">
	and (PATIENT_ID = #{patientId} or RISK_CODE = #{patientId} )
</if>
<if test="patientName != null">
	and PATIENT_NAME like '%${patientName}%'
</if>
order by patient_id
</select>


<select id="listUqs2" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
	select 
	PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
	from UQS_HANDLE_VIEW
	where 1 = 1 
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="start != null">
	and UQS2_DATE &gt;= #{start}
</if>
<if test="end != null">
	and UQS2_DATE &lt;= #{end}
</if>
<if test="patientId != null">
	and (PATIENT_ID = #{patientId} or RISK_CODE = #{patientId} )
</if>
<if test="patientName != null">
	and PATIENT_NAME like '%${patientName}%'
</if>
order by patient_id
</select>

<select id="listUqs3" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
	select 
	PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
	from UQS_HANDLE_VIEW
	where 1 = 1 
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="start != null">
	and UQS3_DATE &gt;= #{start}
</if>
<if test="end != null">
	and UQS3_DATE &lt;= #{end}
</if>
<if test="patientId != null">
	and (PATIENT_ID = #{patientId} or RISK_CODE = #{patientId} )
</if>
<if test="patientName != null">
	and PATIENT_NAME like '%${patientName}%'
</if>
order by patient_id
</select>

<select id="listUqs4" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
	select 
	PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
	from UQS_HANDLE_VIEW
	where 1 = 1 
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="start != null">
	and UQS4_DATE &gt;= #{start}
</if>
<if test="end != null">
	and UQS4_DATE &lt;= #{end}
</if>
<if test="patientId != null">
	and (PATIENT_ID = #{patientId} or RISK_CODE = #{patientId} )
</if>
<if test="patientName != null">
	and PATIENT_NAME like '%${patientName}%'
</if>
order by patient_id
</select>

<select id="listUqs5" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
	select 
	PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
	from UQS_HANDLE_VIEW
	where 1 = 1 
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="start != null">
	and UQS5_DATE &gt;= #{start}
</if>
<if test="end != null">
	and UQS5_DATE &lt;= #{end}
</if>
<if test="patientId != null">
	and (PATIENT_ID = #{patientId} or RISK_CODE = #{patientId} )
</if>
<if test="patientName != null">
	and PATIENT_NAME like '%${patientName}%'
</if>
order by patient_id
</select>

<select id="listUqs6" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
	select 
	PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
	from UQS_HANDLE_VIEW
	where 1 = 1 
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="start != null">
	and UQS6_DATE &gt;= #{start}
</if>
<if test="end != null">
	and UQS6_DATE &lt;= #{end}
</if>
<if test="patientId != null">
	and (PATIENT_ID = #{patientId} or RISK_CODE = #{patientId} )
</if>
<if test="patientName != null">
	and PATIENT_NAME like '%${patientName}%'
</if>
order by patient_id
</select>

<select id="listRisk" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
	select 
	PATIENT_ID, LCC_CODE, PATIENT_NAME, SEX, NATION, ID_NUMBER, RISK_CODE, 
    PATIENT_DATE, UQS1, UQS2, UQS3, UQS4, UQS5, UQS6, UQS1_START, UQS1_END, UQS1_DATE, 
    UQS2_START, UQS2_END, UQS2_DATE, UQS3_START, UQS3_END, UQS3_DATE, UQS4_START, UQS4_END, 
    UQS4_DATE, UQS5_START, UQS5_END, UQS5_DATE, UQS6_START, UQS6_END, UQS6_DATE
	from UQS_HANDLE_VIEW
	where 1 = 1 
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="start != null">
	and RISK_DATE &gt;= #{start}
</if>
<if test="end != null">
	and RISK_DATE &lt;= #{end}
</if>
<if test="patientId != null">
	and (PATIENT_ID = #{patientId} or RISK_CODE = #{patientId} )
</if>
<if test="patientName != null">
	and PATIENT_NAME like '%${patientName}%'
</if>
order by patient_id
</select>

<select id="reportCompletenessForLcc" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
select lcc_code , lcc_name , 
uqs0 ,
round(uqs0/200 , 0 ) as uqs0_per , 
ecg ,
case when uqs4 &gt; 0 then round(ecg*100/uqs4 , 0) else 0 end as ecg_per ,
cch ,
case when uqs4 &gt; 0 then round(cch*100/uqs4 , 0) else 0 end as cch_per ,
ech ,
case when uqs4 &gt; 0 then round(ech*100/uqs4 , 0) else 0 end as ech_per ,
blood,
case when uqs4 &gt; 0 then round(blood*100/uqs4 , 0) else 0 end as blood_per ,
urine,
case when uqs4 &gt; 0 then round(urine*100/uqs4 , 0) else 0 end as urine_per ,
uqs3 ,
uqs4 ,
uqs34 , 
bp ,
case when uqs6 &gt; 0 then round(bp*100/uqs6 , 0) else 0 end as bp_per ,
weight,
case when uqs6 &gt; 0 then round(weight*100/uqs6 , 0) else 0 end as weight_per ,
interviewecg,
case when uqs6 &gt; 0 then round(interviewecg*100/uqs6 , 0) else 0 end as interviewecg_per ,
uqs6 

from 
(select
  lcc_code ,
  (select p.lcc_name from pip_comm_lcc p where p.lcc_code = ttt.lcc_code ) as lcc_name ,
  max(case uqs when '000' then num else 0 end) as uqs0,
  max(case uqs when '001003' then num else 0 end) as uqs3,
  max(case uqs when '001004' then num else 0 end) as uqs4,
  max(case uqs when '003004' then num else 0 end) as uqs34,
  max(case uqs when '001006' then num else 0 end) as uqs6,
  max(case uqs when 'ecg' then num else 0 end) as ecg,
  max(case uqs when 'cch' then num else 0 end) as cch,
  max(case uqs when 'ech' then num else 0 end) as ech,
  max(case uqs when 'blood' then num else 0 end) as blood,
  max(case uqs when 'urine' then num else 0 end) as urine,
  max(case uqs when 'bp' then num else 0 end) as bp,
  max(case uqs when 'weight' then num else 0 end) as weight,
  max(case uqs when 'interviewecg' then num else 0 end) as interviewecg
from
(select lcc_code , uqs , num from
(
select lcc_code , uqs ,  num from
(select lcc_code , '000' as uqs , count(1) as num  from uqs_handle_view where patient_name is not null
<if test="start != null">
	and patient_date &gt;= #{start}
</if>
<if test="end != null">
	and patient_date &lt;= #{end}
</if>
group by lcc_code, '000') u0
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs3 as uqs , count(1) as num  from uqs_handle_view where uqs3 = '001003' 
<if test="start != null">
	and uqs3_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs3_date &lt;= #{end}
</if>
group by lcc_code , uqs3) u3
 UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs4 as uqs , count(1) as num  from uqs_handle_view where uqs4 = '001004' 
<if test="start != null">
	and uqs4_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs4_date &lt;= #{end}
</if>
group by lcc_code , uqs4) u4
UNION ALL   
select lcc_code , uqs ,  num from
(select lcc_code  , '003004' as uqs , count(1) as num  from uqs_handle_view where uqs3 = '001003' and uqs4 = '001004'
<if test="start != null">
	and uqs4_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs4_date &lt;= #{end}
</if>
group by lcc_code, '003004') u34
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , uqs6 as uqs , count(1) as num  from uqs_handle_view where uqs6 = '001006' 
<if test="start != null">
	and uqs6_date &gt;= #{start}
</if>
<if test="end != null">
	and uqs6_date &lt;= #{end}
</if>
group by lcc_code , uqs6) u6
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'ecg' as uqs , count(1) as num  from pip_comm_patient_qa where ecg_date is not null 
<if test="start != null">
	and ecg_date &gt;= #{start}
</if>
<if test="end != null">
	and ecg_date &lt;= #{end}
</if>
group by lcc_code) uecg
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'cch' as uqs , count(1) as num  from pip_comm_patient_qa where cch_date is not null 
<if test="start != null">
	and cch_date &gt;= #{start}
</if>
<if test="end != null">
	and cch_date &lt;= #{end}
</if>
group by lcc_code) ucch
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'ech' as uqs , count(1) as num  from pip_comm_patient_qa where ech_date is not null 
<if test="start != null">
	and ech_date &gt;= #{start}
</if>
<if test="end != null">
	and ech_date &lt;= #{end}
</if>
group by lcc_code) uech
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'blood' as uqs , count(1) as num  from pip_comm_patient_qa where blood_sample_date is not null 
<if test="start != null">
	and blood_sample_date &gt;= #{start}
</if>
<if test="end != null">
	and blood_sample_date &lt;= #{end}
</if>
group by lcc_code) ub
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'urine' as uqs , count(1) as num  from pip_comm_patient_qa where urine_sample_date is not null 
<if test="start != null">
	and urine_sample_date &gt;= #{start}
</if>
<if test="end != null">
	and urine_sample_date &lt;= #{end}
</if>
group by lcc_code) uu
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'bp' as uqs , count(1) as num  from pip_comm_patient_qa where INTERVIEW_BP_DATE is not null 
<if test="start != null">
	and INTERVIEW_BP_DATE &gt;= #{start}
</if>
<if test="end != null">
	and INTERVIEW_BP_DATE &lt;= #{end}
</if>
group by lcc_code) ubp
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'weight' as uqs , count(1) as num  from pip_comm_patient_qa where INTERVIEW_WEIGHT_DATE is not null 
<if test="start != null">
	and INTERVIEW_WEIGHT_DATE &gt;= #{start}
</if>
<if test="end != null">
	and INTERVIEW_WEIGHT_DATE &lt;= #{end}
</if>
group by lcc_code) uw
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code  , 'interviewecg' as uqs , count(1) as num  from pip_comm_patient_qa where INTERVIEW_ECG_DATE is not null 
<if test="start != null">
	and INTERVIEW_ECG_DATE &gt;= #{start}
</if>
<if test="end != null">
	and INTERVIEW_ECG_DATE &lt;= #{end}
</if>
group by lcc_code) uinecg
) t 
) ttt
where 1 = 1
group by lcc_code) t4  
where lcc_code in
<foreach item="item" index="index" collection="datalimits" open="(" separator="," close=")">  
  #{item}  
</foreach>  
<if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
  order by lcc_code
  
  </select>


<select id="mapForArea" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
select 
  area_code,
  case area_code 
  	when '22' then '吉林' 
  	when '21' then '辽宁' 
  	when '33' then '浙江' 
  	when '45' then '广西' 
  	else area_code end as area_name,
  patient,
  followview,
  case when followview > 0 then round(uqs6*100/followview , 0) else 0 end as followview_per,
  risk,
  case when uqs2 > 0 then round(risk*100/uqs2 , 0) else 0 end as risk_per,
  uqs1,
  uqs2,
  uqs34,
  uqs5,
  uqs6
from
(select
  area_code ,
  max(case uqs when 'patient' then num else 0 end) as patient,
  max(case uqs when 'followview' then num else 0 end) as followview,
  max(case uqs when 'risk' then num else 0 end) as risk,
  max(case uqs when '001001' then num else 0 end) as uqs1,
  max(case uqs when '001002' then num else 0 end) as uqs2,
  max(case uqs when '003004' then num else 0 end) as uqs34,
  max(case uqs when '001005' then num else 0 end) as uqs5,
  max(case uqs when '001006' then num else 0 end) as uqs6
from
(select area_code , uqs , num from
(
select area_code , uqs ,  num from
(select substr(lcc_code , 0 ,2 ) as area_code, 'patient' as uqs , count(1) as num  from pip_comm_patient_input where update_date is not null 
group by substr(lcc_code , 0 ,2 ), 'patient') u0
UNION ALL  
select area_code , uqs ,  num from
(select substr(lcc_code , 0 ,2 ) as area_code, 'followview' as uqs , count(1) as num  from pip_comm_patient where IS_FOLLOWVIEW = '1' 
group by substr(lcc_code , 0 ,2 ), 'followview') u0
UNION ALL  
select area_code , uqs ,  num from
(select substr(patient_id , 0 ,2 ) as area_code, 'risk' as uqs , count(1) as num  from uqs_answer_001002_13_1 where risk is not null
group by substr(patient_id , 0 ,2 ), 'risk') u0
UNION ALL  
select area_code , uqs ,  num from
(select substr(lcc_code , 0 ,2 ) as area_code,uqs1 as uqs , count(1) as num  from uqs_handle_view where uqs1 = '001001'
group by substr(lcc_code , 0 ,2 ), uqs1) u1
UNION ALL  
select area_code , uqs ,  num from
(select substr(lcc_code , 0 ,2 ) as area_code,uqs2 as uqs , count(1) as num  from uqs_handle_view where uqs2 = '001002' 
group by substr(lcc_code , 0 ,2 ), uqs2) u2
UNION ALL  
select area_code , uqs ,  num from
(select substr(lcc_code , 0 ,2 ) as area_code, '003004' as uqs , count(1) as num  from uqs_handle_view where uqs3 = '001003' and uqs4 = '001004'
group by substr(lcc_code , 0 ,2 ), '003004') u3
UNION ALL  
select area_code ,uqs ,  num from
(select substr(lcc_code , 0 ,2 ) as area_code,uqs5 as uqs , count(1) as num  from uqs_handle_view where uqs5 = '001005' 
group by substr(lcc_code , 0 ,2 ), uqs5) u5
UNION ALL  
select area_code , uqs ,  num from
(select substr(lcc_code , 0 ,2 ) as area_code,uqs6 as uqs , count(1) as num  from uqs_handle_view where uqs6 = '001006' 
group by substr(lcc_code , 0 ,2 ), uqs6) u6
) t 
) tt group by area_code) ttt
  
  </select>
<select id="mapForLcc" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
select 
  lcc_code,
  lcc_name,
  patient,
  followview,
  case when followview > 0 then round(uqs6*100/followview , 0) else 0 end as followview_per,
  risk,
  case when uqs2 > 0 then round(risk*100/uqs2 , 0) else 0 end as risk_per,
  uqs1,
  uqs2,
  uqs34,
  uqs5,
  uqs6
from
(select
  lcc_code ,
  (select p.lcc_name from pip_comm_lcc p where p.lcc_code = tt.lcc_code ) as lcc_name ,
  max(case uqs when 'patient' then num else 0 end) as patient,
  max(case uqs when 'followview' then num else 0 end) as followview,
  max(case uqs when 'risk' then num else 0 end) as risk,
  max(case uqs when '001001' then num else 0 end) as uqs1,
  max(case uqs when '001002' then num else 0 end) as uqs2,
  max(case uqs when '003004' then num else 0 end) as uqs34,
  max(case uqs when '001005' then num else 0 end) as uqs5,
  max(case uqs when '001006' then num else 0 end) as uqs6
from
(select lcc_code , uqs , num from
(
select lcc_code , uqs ,  num from
(select lcc_code , 'patient' as uqs , count(1) as num  from pip_comm_patient_input where update_date is not null 
group by lcc_code , 'patient') u0
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code , 'followview' as uqs , count(1) as num  from pip_comm_patient where IS_FOLLOWVIEW = '1' 
group by lcc_code , 'followview') u0
UNION ALL  
select lcc_code , uqs ,  num from
(select substr(patient_id , 0 ,4 ) as lcc_code, 'risk' as uqs , count(1) as num  from uqs_answer_001002_13_1 where risk is not null
group by substr(patient_id , 0 ,4 ), 'risk') u0
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code ,uqs1 as uqs , count(1) as num  from uqs_handle_view where uqs1 = '001001'
group by lcc_code , uqs1) u1
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code ,uqs2 as uqs , count(1) as num  from uqs_handle_view where uqs2 = '001002' 
group by lcc_code , uqs2) u2
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code , '003004' as uqs , count(1) as num  from uqs_handle_view where uqs3 = '001003' and uqs4 = '001004'
group by lcc_code, '003004') u3
UNION ALL  
select lcc_code ,uqs ,  num from
(select lcc_code ,uqs5 as uqs , count(1) as num  from uqs_handle_view where uqs5 = '001005' 
group by lcc_code , uqs5) u5
UNION ALL  
select lcc_code , uqs ,  num from
(select lcc_code,uqs6 as uqs , count(1) as num  from uqs_handle_view where uqs6 = '001006' 
group by lcc_code , uqs6) u6
) t 
) tt group by lcc_code) ttt
  
  </select>
  
  <select id="mapForChina" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">

select 
  patient,
  followview,
  case when followview > 0 then round(uqs6*100/followview , 0) else 0 end as followview_per,
  risk,
  case when uqs2 > 0 then round(risk*100/uqs2 , 0) else 0 end as risk_per,
  uqs1,
  uqs2,
  uqs34,
  uqs5,
  uqs6
from
(select
  max(case uqs when 'patient' then num else 0 end) as patient,
  max(case uqs when 'followview' then num else 0 end) as followview,
  max(case uqs when 'risk' then num else 0 end) as risk,
  max(case uqs when '001001' then num else 0 end) as uqs1,
  max(case uqs when '001002' then num else 0 end) as uqs2,
  max(case uqs when '003004' then num else 0 end) as uqs34,
  max(case uqs when '001005' then num else 0 end) as uqs5,
  max(case uqs when '001006' then num else 0 end) as uqs6
from
(select uqs , num from
(
select uqs ,  num from
(select 'patient' as uqs , count(1) as num  from pip_comm_patient_input where update_date is not null 
group by  'patient') u0
UNION ALL  
select  uqs ,  num from
(select  'followview' as uqs , count(1) as num  from pip_comm_patient where IS_FOLLOWVIEW = '1' 
group by  'followview') u0
UNION ALL  
select  uqs ,  num from
(select  'risk' as uqs , ( select count(1) as risk2 from uqs_answer_001002_13_1 where risk is not null) as num  from uqs_handle_view where risk_code is not null
group by  'risk') u0
UNION ALL  
select  uqs ,  num from
(select uqs1 as uqs , count(1) as num  from uqs_handle_view where uqs1 = '001001'
group by  uqs1) u1
UNION ALL  
select  uqs ,  num from
(select uqs2 as uqs , count(1) as num  from uqs_handle_view where uqs2 = '001002' 
group by  uqs2) u2
UNION ALL  
select  uqs ,  num from
(select  '003004' as uqs , count(1) as num  from uqs_handle_view where uqs3 = '001003' and uqs4 = '001004'
group by '003004') u3
UNION ALL  
select uqs ,  num from
(select uqs5 as uqs , count(1) as num  from uqs_handle_view where uqs5 = '001005' 
group by  uqs5) u5
UNION ALL  
select  uqs ,  num from
(select uqs6 as uqs , count(1) as num  from uqs_handle_view where uqs6 = '001006' 
group by  uqs6) u6
) t 
) tt 
) ttt
  
  </select>
  
  <select id="exportForLcc" parameterType="String" resultType="map">
	
select
a.patient_id ,a.lcc_code ,a.patient_name ,decode(a.sex,'1','男 ','2','女 ','') as sex, a.birthday,
max(risk_code) as risk_code,
max(case item_code when '001001' then item_code else null end) as uqs1,
substr(max(case item_code when '001001' then user_code else null end),-3,3) as uqs1code,
max(case item_code when '001002' then item_code else null end) as uqs2,
substr(max(case item_code when '001002' then user_code else null end),-3,3) as uqs2code,
max(case item_code when '001003' then item_code else null end) as uqs3,
substr(max(case item_code when '001003' then user_code else null end),-3,3) as uqs3code,
max(case item_code when '001004' then item_code else null end) as uqs4,
substr(max(case item_code when '001004' then user_code else null end),-3,3) as uqs4code,
max(case item_code when '001005' then item_code else null end) as uqs5,
substr(max(case item_code when '001005' then user_code else null end),-3,3) as uqs5code,
max(case item_code when '001006' then item_code else null end) as uqs6,
substr(max(case item_code when '001006' then user_code else null end),-3,3) as uqs6code,

max(case item_code when '001001' then start_time else null end) as uqs1start,
max(case item_code when '001001' then end_time else null end) as uqs1end,

max(case item_code when '001002' then start_time else null end) as uqs2start,
max(case item_code when '001002' then end_time else null end) as uqs2end,

max(case item_code when '001003' then start_time else null end) as uqs3start,
max(case item_code when '001003' then end_time else null end) as uqs3end,

max(case item_code when '001004' then start_time else null end) as uqs4start,
max(case item_code when '001004' then end_time else null end) as uqs4end,

max(case item_code when '001005' then start_time else null end) as uqs5start,
max(case item_code when '001005' then end_time else null end) as uqs5end,

max(case item_code when '001006' then start_time else null end) as uqs6start,
max(case item_code when '001006' then end_time else null end) as uqs6end
from
(
select patient_id,lcc_code,user_code,patient_name,sex,birthday,risk_code,start_time,end_time,create_date,item_code
  from (select decode(p.patient_id, null, q.patient_id, p.patient_id) as patient_id,
               decode(p.lcc_code, null, q.lcc_code, p.lcc_code) as lcc_code,
               p.patient_name,
               p.sex,
               p.birthday,
               a.user_code,
               p.risk_code,
               q.item_code,
               q.start_time,
               q.end_time,
               q.create_date
          from pip_comm_patient p
          full outer join pip_comm_patient_qc q on (p.patient_id = q.patient_id)
           left join pip_sys_account a
          on q.uqs_operator_id=a.id
          where substr(q.patient_id, 1, 1) != 'G'
                                                  ) ff

UNION ALL  
select patient_id,lcc_code,user_code,patient_name,sex,birthday,risk_code,start_time,end_time,create_date,item_code
  from (select p.patient_id,
               decode(p.lcc_code, null, q.lcc_code, p.lcc_code) as lcc_code,
               p.patient_name,
               p.sex,
               p.birthday,
               a.user_code,
              decode( p.risk_code,null,q.patient_id,p.risk_code) as risk_code,
               q.item_code,
               q.start_time,
               q.end_time,
               q.create_date
          from pip_comm_patient p
          right join pip_comm_patient_qc q on (p.risk_code = q.patient_id)
          left join pip_sys_account a
          on q.uqs_operator_id=a.id
          where substr(q.patient_id, 1, 1) = 'G'
                                                  ) ff

   )a
   where a.lcc_code = #{lccCode,jdbcType=VARCHAR}
   group by a.patient_id,a.lcc_code,a.patient_name,a.sex,a.risk_code, a.birthday
   order by a.patient_id,a.lcc_code,a.patient_name,a.sex,a.risk_code
	

</select>

<select id="uqs1Trend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
 select to_char(uqs1_date , 'yyyy-MM-dd') as item_date , count(1) as num from uqs_handle_view
	where uqs1_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(uqs1_date , 'yyyy-MM-dd')
 order by to_char(uqs1_date , 'yyyy-MM-dd')
</select>

<select id="uqs2Trend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
 select to_char(uqs2_date , 'yyyy-MM-dd') as item_date , count(1) as num from uqs_handle_view
	where uqs2_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(uqs2_date , 'yyyy-MM-dd')
 order by to_char(uqs2_date , 'yyyy-MM-dd')
</select>

<select id="uqs3Trend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
 select to_char(uqs3_date , 'yyyy-MM-dd') as item_date , count(1) as num from uqs_handle_view
	where uqs3_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(uqs3_date , 'yyyy-MM-dd')
 order by to_char(uqs3_date , 'yyyy-MM-dd')
</select>

<select id="uqs4Trend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
 select to_char(uqs4_date , 'yyyy-MM-dd') as item_date , count(1) as num from uqs_handle_view
	where uqs4_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(uqs4_date , 'yyyy-MM-dd')
 order by to_char(uqs4_date , 'yyyy-MM-dd')
</select>

<select id="uqs34Trend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
 select to_char(uqs4_date , 'yyyy-MM-dd') as item_date , count(1) as num from uqs_handle_view
	where uqs4_date is not null and uqs3_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(uqs4_date , 'yyyy-MM-dd')
 order by to_char(uqs4_date , 'yyyy-MM-dd')
</select>


<select id="uqs5Trend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
 select to_char(uqs5_date , 'yyyy-MM-dd') as item_date , count(1) as num from uqs_handle_view
	where uqs5_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(uqs5_date , 'yyyy-MM-dd')
 order by to_char(uqs5_date , 'yyyy-MM-dd')
</select>

<select id="uqs6Trend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
 select to_char(uqs6_date , 'yyyy-MM-dd') as item_date , count(1) as num from uqs_handle_view
	where uqs6_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(uqs6_date , 'yyyy-MM-dd')
 order by to_char(uqs6_date , 'yyyy-MM-dd')
</select>

<select id="riskTrend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
 select to_char(risk , 'yyyy-MM-dd') as item_date ,count(1) num from uqs_answer_001002_13_1 
 where risk is not null
 <if test="lccCode != null">
	and substr(patient_id , 0 ,4 )  = #{lccCode}
</if>
<if test="area_code != null">
	and substr(patient_id , 0 ,2 )  = #{area_code}
</if>  
 group by to_char(risk , 'yyyy-MM-dd')
 order by to_char(risk , 'yyyy-MM-dd')
</select>

<select id="ecgTrend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
  select to_char(ecg_date , 'yyyy-MM-dd') as item_date , count(1) as num from pip_comm_patient_qa 
 where ecg_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(ecg_date , 'yyyy-MM-dd')
 order by to_char(ecg_date , 'yyyy-MM-dd')
</select>


<select id="cchTrend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
  select to_char(cch_date , 'yyyy-MM-dd') as item_date , count(1) as num from pip_comm_patient_qa 
 where cch_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(cch_date , 'yyyy-MM-dd')
 order by to_char(cch_date , 'yyyy-MM-dd')
</select>

<select id="sampleTrend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
  select to_char(blood_sample_date , 'yyyy-MM-dd') as item_date , count(1) as num from pip_comm_patient_qa 
 where blood_sample_date is not null and urine_sample_date is not null
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by to_char(blood_sample_date , 'yyyy-MM-dd')
 order by to_char(blood_sample_date , 'yyyy-MM-dd')
</select>


<select id="tubeTrend" parameterType="com.bdcor.pip.web.progress.filter.ProgressFilter" resultType="map">
  select decode (to_char(create_date , 'yyyy-MM-dd') , null , '2014-11-01', to_char(create_date , 'yyyy-MM-dd') ) as item_date  , round(count(1) / 7, 0 ) as num from pip_scm_frozentube 
 where 1 = 1 
 <if test="lccCode != null">
	and lcc_code = #{lccCode}
</if>
<if test="area_code != null">
	and lcc_code like '${area_code}%'
</if>  
 group by decode (to_char(create_date , 'yyyy-MM-dd') , null , '2014-11-01', to_char(create_date , 'yyyy-MM-dd') )
 order by decode (to_char(create_date , 'yyyy-MM-dd') , null , '2014-11-01', to_char(create_date , 'yyyy-MM-dd') )
</select>

</mapper>